<!DOCTYPE html>
<html>
<head>
    <title>ProTag - {{producer.producer_name}}</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link href="/static/style.css" rel="stylesheet"></link>
  <link href="http://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">
  <script src="https://code.jquery.com/jquery.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/4.1.1/d3.min.js"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.2.1/Chart.js"></script>
  <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>   
</head>

<body>
      <!-- navigation bar -->
    <div class="topnav">
      <a class="active" href="/">Home</a>
      <a href="/performers">Performers</a>
      <a href="/producers">Producers</a>
      <a href="/network">Network</a>
      <a href="/resume">Hire Me!</a>
    </div>

    <h1 align = "center">{{producer.producer_name}}</h1>

    {% if producer.songs %}
        <ul>
        <!-- alt = message when hovering over -->
        <!-- producer's image -->
        <img src="{{ producer.producer_img_url }}" width="250" height="200" alt="{{ producer.producer_name }}">
        <!-- autoplay: https://www.youtube.com/embed/gN-JxixTeqg?autoplay=1 -->
        {% if producer.producer_tag_url %}
            Signature: 
            <iframe width="40" height="40" src="https://www.youtube.com/embed/{{ producer.producer_tag_url }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </iframe>
            <br>
            <br>
        {% endif %}
        <br>
        <br>
        {{ bio }}
        <br>
        <br>
        <h3>Number of songs {{ producer.producer_name }} has produced by performer</h3>
        <div id="bubble-chart"></div>

        <script>

        var width = 1000, height = 900,
            color = d3.scale.category10();

        var chart = d3.select("#bubble-chart").append("svg")
            .attr("width", width).attr("height", height)
            .append("g")
            .attr("transform", "translate(50,50)");

        var pack = d3.layout.pack()
            .size([width, height - 50])
            .padding(10);

        var force = d3.layout.force()
            .size([width, height - 50]);

        d3.json("/producer-bubbles.json", function(data) {

          force.nodes(data).start();

          var nodes = pack.nodes(data);

          var node = chart.selectAll(".node")
              .data(nodes).enter()
              .append("g")
              .attr("class", "node")
              .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
              .call(force.drag);

          node.append("circle")
              .attr("r",function(d) { return d.r; })
              .attr("fill", function(d){ return d.children ? "#fff" : color(d.domain); }) //make nodes with children invisible
              .attr("opacity", 0.6)

          node.append("a")
              .append("text")
              .attr("font-family", "sans-serif")
              .attr("font-size", function(d){ return d.r/2; })
              .attr("dy", ".3em").style("text-anchor", "middle")
              .text(function(d) { if(d.name.length < 10){return d.children ? "" : d.name; }})

            node.append("a")
              .append("text")
              .attr("font-family", "sans-serif")
              .attr("font-size", function(d){ return d.r/2.5; })
              .attr("dy", ".3em").style("text-anchor", "middle")
              .text(function(d) { if(d.name.length >= 10){return d.children ? "" : d.name; }})

          node.append("a")
              .append("text")
              .attr("font-family", "sans-serif")
              .attr("font-size", function(d){ return d.r/2.5; })
              .style("text-anchor", "middle")
              .attr("dy", "-1em")
              .text(function(d) { return d.children ? "" : d.value; });
        });

        </script>

    <br>
<!-- return every song producer has producer by album and year -->
      <h2>Albums</h2>
        {% for year in album_years %}
                <h2>{{year}}</h2>
                {% for album in producer.albums %}
                    {% if album.album_release_date.strftime("%Y") == year %}
                        <h3><a href="/albums/{{ album.album_id }}">{{ album.album_title }}</a> - <a href="/performers/{{ album.performers[0].performer_id }}">{{ album.performers[0].performer_name }}</a></h3>
                        <img src="{{ album.cover_art_url }}" width="250" height="200" alt="{{ album.album_title }}">
                        {% for song in album.songs %} 
                            {% if producer in song.producers %}
                            <li>
                            <a href="/songs/{{ song.song_id }}">{{ song.song_title }}</a>
                            </li>
                            {% endif %}
                        {% endfor %}
                        <br>
                    {% endif %}
                {% endfor %}
        {% endfor %}
    {% endif %}
<!-- add songs not on albums and songs/albums without release dates -->
</body>

<footer>
    <br>
    <br> 
    Thanks, <a href= "https://genius.com/" alt="Genius"><img src="http://images.genius.com/8ed669cadd956443e29c70361ec4f372.1000x1000x1.png" width="25" height="20" ></a> and <a href="https://geo.itunes.apple.com/us/" style="display:inline-block;overflow:hidden;background:url(https://tools.applemusic.com/embed/v1/app-icon.svg) no-repeat;width:40px;height:40px;"></a>!
</footer>
</html>